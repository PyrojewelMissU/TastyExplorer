const o=new Map,c=async(r,n="en",a="zh")=>{try{const e=`https://api.mymemory.translated.net/get?q=${encodeURIComponent(r)}&langpair=${n}|${a}`,t=await(await fetch(e)).json();return t.responseStatus===200&&t.responseData?t.responseData.translatedText:null}catch(e){return console.error("MyMemory翻译失败:",e),null}},l=async(r,n="en",a="zh")=>{try{const t=await(await fetch("https://libretranslate.de/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({q:r,source:n,target:a,format:"text"})})).json();return t.translatedText?t.translatedText:null}catch(e){return console.error("LibreTranslate翻译失败:",e),null}},i=async(r,n="en",a="zh-CN")=>{if(!r||typeof r!="string")return r;const e=r.trim();if(!e)return r;const s=`${n}:${a}:${e}`;if(o.has(s))return o.get(s);try{let t=await c(e,n,"zh");return t||(t=await l(e,n,"zh")),t?(o.set(s,t),t):r}catch(t){return console.error("翻译失败:",t),r}};export{i as translateText};
